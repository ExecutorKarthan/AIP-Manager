function requestHighlighter() {
class AIPSheets{
    constructor(startDate, endDate, url){
      this.startDate = startDate;
      this.endDate = endDate;
      this.url = url;
    }
  }

  function checkDayOfWeek(now){
    var currentInDict = daysPossible[now.getDay()];
    if(currentInDict != undefined){
      return true;
    }
    else{
      return false;
    }
  }

  //Create time references
  var now = new Date();
  var targetTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 10, 05, 0, 0);
  var daysPossible = {1:"Mon", 2:"Tues", 3:"Wed", 4:"Thurs", 5 :"Fri"}
  var sourceSheet = SpreadsheetApp.openByUrl("https://docs.google.com/spreadsheets/d/1OE_bEE2AGaTTnkACDo52vZmw8uwcZDSffpMjMq8_Xv8/edit#gid=0");
  var startWeekDate = new Date(sourceSheet.getSheetByName("Sheet Index").getRange(2, 1).getValue());
  var endWeekDate = new Date(sourceSheet.getSheetByName("Sheet Index").getRange(2, 2).getValue()).setHours(14);
  var needToRun = checkDayOfWeek(now);

  if(now > startWeekDate && now < endWeekDate && needToRun && (now - targetTime + 120000) >= 0){
      //hang until the time is correct
    while((now - targetTime) < 0){
      console.log("I am sleeping to wait");
      Utilities.sleep(20000)
      now = new Date();
    }

    //Open the source sheets and get their information

    var sheetIndex = sourceSheet.getSheetByName("Sheet Index");

    //Create sheet objects to help locate the correct sheet
    var sheetObjects = [];
    var row = 1
    var rowValues = sheetIndex.getRange(row, 1, 1, 3).getValues()
    while(rowValues[0][0] != ""){
      if(rowValues[0][0] == "Start Date"){
        row = row + 1;
        rowValues = sheetIndex.getRange(row, 1, 1, 3).getValues()
        continue
      }
      else{
        sheetObjects.push(new AIPSheets(rowValues[0][0], rowValues[0][1], rowValues[0][2]));
        row = row + 1;
        rowValues = sheetIndex.getRange(row, 1, 1, 3).getValues()
      }
    } 

    //loop through the list looking for the right sheet to edit
    for(var sheet = 0; sheet < sheetObjects.length; sheet++){
      //Create a date range to test. If the value is after the start(+) but before the end (-), then it is the right sheet
      var startComp = sheetObjects[sheet].startDate;
      var endComp = sheetObjects[sheet].endDate;
      if((now - startComp >-1) && ((now - endComp < 0) || (now - endComp < 86400000 && now - endComp > -1))){
        var targetSpreadsheet = SpreadsheetApp.openByUrl(sheetObjects[sheet].url).getSheets();
        now = new Date();
        var targetDay = daysPossible[now.getDay()]
        for(var dayTab = 0; dayTab < targetSpreadsheet.length; dayTab++){
          if(targetSpreadsheet[dayTab].getName() == targetDay){
            var lastRow = targetSpreadsheet[dayTab].getLastRow();
            var weekData = targetSpreadsheet[dayTab].getRange(4, 1, lastRow, 7).getValues();
            console.log("Script made it through and is now yellowing cells")
            weekData.forEach((cell, index)=>{
              if(cell[3] != "" || cell[4] != "" || cell[5] != "" || cell[6] != ""){
                targetSpreadsheet[dayTab].getRange((index+4), 1, 1, 1).setBackground("yellow");
                }
              }
            )
          }
        }
        deleteTimers();
        setTimeTrigger();
        break
      }
      else{
        console.log("No sheet matches - no update requires updating.")
      }
    }
  }
   //If time is incorrect, create a new trigger to let the program loop.
  else if(needToRun && (now - targetTime) < 0 ){
    deleteTimers();
    ScriptApp.newTrigger("requestHighlighter").timeBased().everyMinutes(5).create();
    var min = Math.floor(now.getMinutes() + 5);
    var hour = Math.floor(now.getHours());
    if(min > 59){
      min = min - 59;
      hour = hour +1;
    }
    console.log("Incorrect time - create new trigger for "+ hour + ":" + min);
  }
  else{
    console.log("Incorrect day - nothing to highlight");
  }
}
